# 🌏 Web 项目开发标准作业程序 (SOP)

适用范围：中大型全栈 Web 应用开发

目标：确保项目从构思到上线流程清晰、架构稳健、可维护性强。

------

## 🟢 第一阶段：需求分析与产品定义 (What & Why)

*在写一行代码之前，先想清楚要做什么。*

### 1.1 核心价值定义

-   [ ] **一句话描述**：项目是为了解决什么人的什么痛点？
-   [ ] **核心功能 (MVP)**：列出 3-5 个必须有的功能（不要贪多）。
-   [ ] **用户角色**：谁会使用？（例如：普通用户、管理员、访客）。

### 1.2 功能清单梳理 (Feature List)

-   [ ] **用户故事**：以“作为[角色]，我想要[功能]，以便于[目的]”的格式记录。
-   [ ] **流程图绘制**：绘制核心业务流程图（例如：用户从登录到完成任务的路径）。

------

## 🔵 第二阶段：技术架构与选型 (How)

*这是项目的骨架，决定了后期的性能和扩展性。*

### 2.1 宏观架构设计

-   [ ] **渲染模式选择**：
    -   CSR (React/Vue SPA) - *适合强交互应用，如你的 Canvas GTD*。
    -   SSR (Next.js/Nuxt) - *适合内容型、SEO 要求高的应用*。
-   [ ] **数据同步策略**：
    -   传统 REST/GraphQL API。
    -   Local-First (RxDB/ElectricSQL) - *适合离线优先应用*。
-   [ ] **代码仓库结构**：
    -   Monorepo (Turborepo/Nx) - *适合前后端紧密关联的项目*。
    -   Polyrepo - *适合完全解耦的独立服务*。

### 2.2 技术栈清单 (Tech Stack)

-   [ ] **前端**：框架 (React), 构建 (Vite), 状态管理 (Zustand/RxDB), UI (Tailwind/AntD)。
-   [ ] **后端**：框架 (NestJS/Hono), 语言 (TS/Go)。
-   [ ] **数据库**：关系型 (Postgres), 文档型 (Mongo), 缓存 (Redis)。
-   [ ] **基础设施**：Docker, Nginx, SSL 证书提供商。

------

## 🟡 第三阶段：详细设计 (The Blueprint)

*这是最容易被忽略，但最重要的环节。*

### 3.1 数据库设计 (Schema First)

-   [ ] **ER 图绘制**：设计表结构，确定实体之间的关系 (1:1, 1:N, N:M)。
-   [ ] **字段定义**：确定字段类型、索引、主键、外键。

-   [ ] **ORM 实体编写**：在编码前先写好 TypeORM/Prisma 的 Schema。

### 3.2 API 接口设计

-   [ ] **接口定义**：URL 路径 (e.g., `GET /api/tasks`)，Request Body，Response Body。
-   [ ] **错误码规范**：统一定义 401, 403, 404, 500 的返回格式。
-   [ ] **类型共享**：(如果是 Monorepo) 在 `packages/shared-types` 定义好 DTO。

### 3.3 UI/UX 设计

-   [ ] **原型图 (Wireframe)**：简单的手绘或低保真原型，确定布局。
-   [ ] **视觉设计**：确定主色调、字体、圆角风格。
-   [ ] **组件拆解**：看着设计图，把页面拆解为“原子组件” (Button) 和 “业务组件” (TaskCard)。

------

## 🟠 第四阶段：环境搭建与初始化 (Setup)

*工欲善其事，必先利其器。*

### 4.1 仓库初始化

-   [ ] `git init` & `.gitignore` 配置。
-   [ ] 配置 Lint 工具 (Eslint, Prettier) 和 Git Hooks (Husky) —— *保证代码风格统一*。
-   [ ] 配置环境变量模版 `.env.example`。

### 4.2 容器化环境

-   [ ] 编写 `docker-compose.dev.yml`：配置数据库、Redis 等依赖服务。
-   [ ] 确保本地开发只需一句 `docker compose up` 即可启动数据库。

------

## 🔴 第五阶段：开发与迭代 (Implementation)

*遵循“后端先行，前端跟进”或“全栈闭环”的策略。*

### 5.1 后端开发

1.  **Model 层**：建立数据库表。
2.  **Service 层**：编写核心业务逻辑（增删改查）。
3.  **Controller 层**：暴露 API 接口。
4.  **测试**：用 Postman 或单元测试验证接口。

### 5.2 前端开发

1.  **API 接入**：封装 Axios/Fetch 请求，或配置 RxDB Schema。
2.  **组件开发**：先写基础 UI 组件，再写业务组件。
3.  **页面组装**：将组件拼装到 Page 中，配置路由。
4.  **状态对接**：将 API 数据对接进组件。

### 5.3 关键检查点

-   [ ] **CORS 处理**：开发环境配置 Proxy 代理 (`/api` -> `localhost:3000`)。
-   [ ] **硬编码检查**：确保没有 `http://localhost` 这种写死的地址，全部走环境变量。

------

## 🟣 第六阶段：测试与质量保证 (QA)

-   [ ] **单元测试**：针对复杂的计算逻辑或数据处理逻辑。
-   [ ] **E2E 测试**：(Playwright) 模拟用户核心流程（注册->登录->核心功能）。
-   [ ] **构建测试**：在本地运行 `npm run build` 和 `docker build`，确保生产环境能打包成功。

------

## ⚫ 第七阶段：部署与运维 (Deployment)

*这是你最近刚刚掌握的核心技能。*

### 7.1 服务器准备

-   [ ] 购买服务器 & 域名解析。
-   [ ] 安装 Docker, Nginx, Git。

### 7.2 上线配置

-   [ ] **HTTPS**：Certbot 申请证书。
-   [ ] **Nginx 反向代理**：配置 `proxy_pass` 指向 Docker 容器。
-   [ ] **环境变量**：在服务器创建生产环境 `.env` 文件（填入真实密码）。

### 7.3 自动化 (CI/CD)

-   [ ] (进阶) 配置 GitHub Actions：代码 Push 后自动构建镜像并部署。

------

## ⚪ 第八阶段：交付与维护 (Maintenance)

-   [ ] **文档归档**：整理 API 文档、部署文档到 `docs/` 目录。
-   [ ] **备份策略**：设置数据库定时备份脚本。
-   [ ] **监控**：定期检查服务器 CPU/内存和 Docker 日志。